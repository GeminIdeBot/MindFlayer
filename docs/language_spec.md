# Спецификация языка MindFlayer

## Введение
MindFlayer — это эзотерический, стековый язык программирования, разработанный для "взлома мозга" программиста. Он оперирует абстрактными "мыслями" (целыми числами) в двух стеках: "сознании" (основной стек) и "подсознании" (вспомогательный стек). Операции языка не всегда очевидны и могут приводить к неожиданным результатам.

## Данные
Язык оперирует байтами (целыми числами от 0 до 255). Каждый стек может содержать до 30000 таких байтов.

## Стек
MindFlayer использует два стека:
*   **Сознание (Main Stack):** Основной рабочий стек. Указатель `edi` в ассемблере.
*   **Подсознание (Subconscious Stack):** Вспомогательный стек. Указатель `esi` в ассемблере.

## Инструкции

| Символ | Название    | Описание                                                                                                                              | Ассемблерная реализация                                                                                                                                                                                                 |
|--------|-------------|---------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `F`    | Flash       | Генерирует случайное число (0-255) и помещает его в "сознание" (главный стек).                                                         | `mov byte [edi], {random_value}` <br> `inc edi`                                                                                                                                                                         |
| `S`    | Shadow      | Перемещает верхнюю "мысль" из "сознания" в "подсознание" (второй стек). Если "сознание" пусто, создает 0 и перемещает его.             | `dec edi` <br> `mov al, byte [edi]` <br> `inc esi` <br> `mov byte [esi], al`                                                                                                                                            |
| `C`    | Clarity     | Перемещает верхнюю "мысль" из "подсознания" в "сознание". Если "подсознание" пусто, создает 0 и перемещает его.                       | `dec esi` <br> `mov al, byte [esi]` <br> `inc edi` <br> `mov byte [edi], al`                                                                                                                                            |
| `D`    | Distort     | Берет верхнюю "мысль" из "сознания", применяет к ней сложную битовую операцию: `(value XOR 0xAA) + 0x55`, и помещает результат обратно. | `dec edi` <br> `mov al, byte [edi]` <br> `xor al, 0xAA` <br> `add al, 0x55` <br> `mov byte [edi], al` <br> `inc edi`                                                                                                      |
| `E`    | Echo        | Дублирует верхнюю "мысль" в "сознании".                                                                                               | `dec edi` <br> `mov al, byte [edi]` <br> `inc edi` <br> `mov byte [edi], al` <br> `inc edi`                                                                                                                            |
| `V`    | Void        | Удаляет верхнюю "мысль" из "сознания".                                                                                                | `dec edi`                                                                                                                                                                                                               |
| `M`    | Merge       | Берет две верхние "мысли" (A, B) из "сознания" (A - ниже, B - выше), вычисляет `(A XOR B) AND (A OR B)` и помещает результат обратно. | `dec edi` (для B) <br> `mov bl, byte [edi]` <br> `dec edi` (для A) <br> `mov al, byte [edi]` <br> `xor bh, bl` (bh = A XOR B) <br> `or cl, bl` (cl = A OR B) <br> `and bh, cl` <br> `mov byte [edi], bh` <br> `inc edi` |
| `P`    | Print       | Выводит верхнюю "мысль" из "сознания" как символ.                                                                                    | `dec edi` <br> `mov eax, 4` <br> `mov ebx, 1` <br> `mov ecx, edi` <br> `mov edx, 1` <br> `int 0x80` <br> `inc edi`                                                                                                      |
| `I`    | Input       | Считывает символ и помещает его ASCII-значение как "мысль" в "сознание".                                                             | `mov eax, 3` <br> `mov ebx, 0` <br> `mov ecx, edi` <br> `mov edx, 1` <br> `int 0x80` <br> `inc edi`                                                                                                                     |
| `L`    | Loop        | Начинает цикл. Если верхняя "мысль" в "сознании" равна нулю, переходит к соответствующему `K` (КонецПетли).                          | `{label_start}:` <br> `dec edi` <br> `cmp byte [edi], 0` <br> `je {label_end}` <br> `inc edi`                                                                                                                           |
| `K`    | Kloop       | Завершает цикл. Если верхняя "мысль" в "сознании" не равна нулю, переходит к соответствующему `L` (Петля).                           | `dec edi` <br> `cmp byte [edi], 0` <br> `jne {label_start}` <br> `inc edi` <br> `{label_end}:`                                                                                                                           |

## Комментарии
Любые символы, не входящие в список инструкций, игнорируются и могут использоваться для комментариев или форматирования.

## Пример "Hello, World!" (псевдокод)
```
# Пока нет простого способа инициализировать стек конкретными значениями
# Придется использовать комбинацию F, D, S, C для достижения нужных значений.
# Это делает "Hello, World!" очень сложным для MindFlayer.
# Пример будет добавлен после реализации более удобных способов манипуляции стеком.